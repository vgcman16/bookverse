<?xml version="1.0" encoding="utf-8"?>
<Page xmlns="http://schemas.nativescript.org/tns.xsd" navigatingTo="onNavigatingTo" class="page">
    <ActionBar title="Login" class="action-bar">
        <NavigationButton visibility="collapsed" />
    </ActionBar>

    <ScrollView>
        <StackLayout class="p-20">
            <Image src="~/assets/images/logo.png" class="logo m-b-30" />
            
            <Label text="Welcome back!" class="h1 text-center m-b-20" />
            
            <!-- Email Input -->
            <StackLayout class="input-field m-b-20">
                <Label text="Email" class="input-label" />
                <TextField id="email-input"
                          text="{{ email }}"
                          keyboardType="email"
                          autocorrect="false"
                          autocapitalizationType="none"
                          class="input" />
                <Label text="{{ emailError }}" 
                       class="error-message"
                       visibility="{{ emailError ? 'visible' : 'collapsed' }}" />
            </StackLayout>

            <!-- Password Input -->
            <StackLayout class="input-field m-b-20">
                <Label text="Password" class="input-label" />
                <TextField id="password-input"
                          text="{{ password }}"
                          secure="true"
                          class="input" />
                <Label text="{{ passwordError }}"
                       class="error-message"
                       visibility="{{ passwordError ? 'visible' : 'collapsed' }}" />
            </StackLayout>

            <!-- Remember Me & Forgot Password -->
            <GridLayout rows="auto" columns="*, *" class="m-b-20">
                <StackLayout orientation="horizontal" col="0">
                    <Switch checked="{{ rememberMe }}" />
                    <Label text="Remember me" class="m-l-5" />
                </StackLayout>
                <Label text="Forgot Password?"
                       class="text-right"
                       col="1"
                       tap="{{ onForgotPassword }}" />
            </GridLayout>

            <!-- Login Button -->
            <Button id="login-button"
                    text="Login"
                    tap="{{ onLogin }}"
                    isEnabled="{{ !isLoading }}"
                    class="btn btn-primary m-b-20" />

            <!-- Google Sign In -->
            <Button id="google-login-button"
                    text="Sign in with Google"
                    tap="{{ onGoogleLogin }}"
                    isEnabled="{{ !isLoading }}"
                    class="btn btn-outline m-b-20">
                <FormattedString>
                    <Span text="&#xf1a0; " class="fab" />
                    <Span text="Sign in with Google" />
                </FormattedString>
            </Button>

            <!-- Sign Up Link -->
            <StackLayout orientation="horizontal" horizontalAlignment="center">
                <Label text="Don't have an account? " />
                <Label text="Sign up"
                       id="signup-link"
                       tap="{{ onSignUp }}"
                       class="font-weight-bold" />
            </StackLayout>

            <!-- Loading Indicator -->
            <ActivityIndicator busy="{{ isLoading }}"
                             visibility="{{ isLoading ? 'visible' : 'collapsed' }}"
                             class="m-t-20" />

            <!-- Error Message -->
            <Label id="login-error"
                   text="{{ errorMessage }}"
                   class="error-message text-center"
                   textWrap="true"
                   visibility="{{ errorMessage ? 'visible' : 'collapsed' }}"
                   margin="10" />
        </StackLayout>
    </ScrollView>
</Page>
